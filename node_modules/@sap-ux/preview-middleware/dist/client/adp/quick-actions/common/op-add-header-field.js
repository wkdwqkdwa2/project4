"use strict";

sap.ui.define(["sap/ui/dt/OverlayRegistry", "../../../adp/init-dialogs", "../../../cpe/quick-actions/utils", "../../../utils/core", "../simple-quick-action-base"], function (OverlayRegistry, _____adp_init_dialogs, _____cpe_quick_actions_utils, _____utils_core, ___simple_quick_action_base) {
  "use strict";

  const DialogNames = _____adp_init_dialogs["DialogNames"];
  const handler = _____adp_init_dialogs["handler"];
  const getRelevantControlFromActivePage = _____cpe_quick_actions_utils["getRelevantControlFromActivePage"];
  const isA = _____utils_core["isA"];
  const SimpleQuickActionDefinitionBase = ___simple_quick_action_base["SimpleQuickActionDefinitionBase"];
  const OP_ADD_HEADER_FIELD_TYPE = 'op-add-header-field';
  const CONTROL_TYPES = ['sap.uxap.ObjectPageLayout'];

  /**
   * Quick Action for adding a Header Field to an Object Page.
   */
  class AddHeaderFieldQuickAction extends SimpleQuickActionDefinitionBase {
    constructor(context) {
      super(OP_ADD_HEADER_FIELD_TYPE, CONTROL_TYPES, 'QUICK_ACTION_OP_ADD_HEADER_FIELD', context);
    }
    async execute() {
      const objectPageLayout = getRelevantControlFromActivePage(this.context.controlIndex, this.context.view, CONTROL_TYPES)[0];
      const headerContent = objectPageLayout.getHeaderContent();

      // check if only flex box exist in the headerContent.
      if (headerContent.length === 1 && isA('sap.m.FlexBox', headerContent[0])) {
        const overlay = OverlayRegistry.getOverlay(headerContent[0]) || [];
        await handler(overlay, this.context.rta, DialogNames.ADD_FRAGMENT, undefined, {
          aggregation: 'items',
          title: 'QUICK_ACTION_OP_ADD_HEADER_FIELD'
        });
      } else if (this.control) {
        const overlay = OverlayRegistry.getOverlay(this.control) || [];
        await handler(overlay, this.context.rta, DialogNames.ADD_FRAGMENT, undefined, {
          aggregation: 'headerContent',
          title: 'QUICK_ACTION_OP_ADD_HEADER_FIELD'
        });
      }
      return [];
    }
  }
  var __exports = {
    __esModule: true
  };
  __exports.OP_ADD_HEADER_FIELD_TYPE = OP_ADD_HEADER_FIELD_TYPE;
  __exports.AddHeaderFieldQuickAction = AddHeaderFieldQuickAction;
  return __exports;
});
//# sourceMappingURL=op-add-header-field.js.map